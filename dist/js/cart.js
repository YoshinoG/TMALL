$(function(){var l=JSON.parse(getCookie("cart")),a=getCookie("user_id");for(var c in l)if(c==a){for(var i in l[c])!function(e){$.ajax({type:"get",url:"http://h6.duchengjiu.top/shop/api_goods.php",data:{goods_id:e},success:function(i){var t="<ul class='item' goods_id='"+i.data[0].goods_id+"'><li><input type='checkbox'></li><li><a href='detail.html?goods_id="+i.data[0].goods_id+"'><img src='"+i.data[0].goods_thumb+"' alt=''></a><a href='detail.html?goods_id="+i.data[0].goods_id+"'>"+i.data[0].goods_name+"</a></li><li></li><li>￥<span class='p'>"+i.data[0].price+"</span></li><li><p><span class='less'>-</span><input type='text' class='number' value='"+l[c][e]+"'><span class='plus'>+</span></p></li><li>￥<span class='tp'>"+l[c][e]*i.data[0].price+"</span></li><li><a href='' class='del'>删除</a></li></ul>";function s(){for(var i=$("#main input:checked").closest(".item"),t=0,s=0,e=0;e<i.length;e++)t+=- -i.eq(e).find(".number").val(),s+=- -i.eq(e).find(".tp").html();$("#number").html(t),$("#total").html(s)}$("#main").append(t),$(".less").unbind("click").click(function(){var i=$(this).closest(".item").find(".number");if(i.val()&&0!=i.val()){i.val(i.val()-1);var t=$(this).closest(".item").attr("goods_id");$(this).closest(".item").find(".tp").html($(this).closest(".item").find(".tp").html()-$(this).closest(".item").find(".p").html()),l[a][t]--,setCookie("cart",JSON.stringify(l),7),s()}}),$(".plus").unbind("click").click(function(){var i=$(this).closest(".item").find(".number");i.val(i.val()-0+1);var t=$(this).closest(".item").attr("goods_id");$(this).closest(".item").find(".tp").html($(this).closest(".item").find(".tp").html()- -$(this).closest(".item").find(".p").html()),l[a][t]++,setCookie("cart",JSON.stringify(l),7),s()}),$(".del").unbind("click").click(function(){var i=$(this).closest(".item").attr("goods_id");delete l[a][i],setCookie("cart",JSON.stringify(l),7)}),$(".all").unbind("click").on("click",function(){$("#main input:checkbox").prop("checked",$(this).prop("checked")),s()}),$("#main input:checkbox").unbind("click").click(function(){s()})}})}(i);break}});